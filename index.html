<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>‚ö° –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏: –ò–ò + –ø–æ–¥—Å–∫–∞–∑–∫–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            min-height: 100vh;
            background: radial-gradient(circle at 30% 30%, #0a0f1e, #03050a);
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }

        .game-container {
            max-width: 500px;
            width: 100%;
            background: rgba(12, 20, 30, 0.7);
            backdrop-filter: blur(15px);
            border: 2px solid #2c3f5c;
            border-radius: 48px;
            padding: 24px 20px 30px;
            box-shadow: 0 30px 45px rgba(0,0,0,0.8), 0 0 20px #3f6a9c;
            text-align: center;
            color: #e5f0ff;
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 800;
            letter-spacing: 5px;
            margin-bottom: 0;
            text-transform: uppercase;
            background: linear-gradient(135deg, #b3d9ff, #7aaae0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 15px #3f8eff;
        }

        .sub {
            font-size: 1rem;
            color: #8ba9cc;
            margin-bottom: 15px;
            border-bottom: 1px dashed #2f4a6b;
            padding-bottom: 8px;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats {
            display: flex;
            justify-content: space-around;
            background: #0f1a24;
            border-radius: 60px;
            padding: 12px 10px;
            margin-bottom: 20px;
            border: 2px solid #2e4b70;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .stat-value {
            background: #1e3140;
            padding: 5px 14px;
            border-radius: 30px;
            color: #d2e6ff;
            border: 1px solid #3e6a99;
            min-width: 45px;
        }

        /* –í—ã–±–æ—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ */
        .difficulty {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            background: #1f3140;
            border: 2px solid #2f5375;
            color: #b7d4f0;
            padding: 8px 20px;
            border-radius: 40px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 0 5px 0 #0b121a;
            flex: 1 1 100px;
        }

        .difficulty-btn.active {
            background: #34638a;
            border-color: #8fc9ff;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #0b121a, 0 0 15px #3e9eff;
        }

        .difficulty-btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #0b121a;
        }

        /* –ü–æ–ª–µ */
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
            aspect-ratio: 1/1;
            background: #0f1924;
            padding: 12px;
            border-radius: 40px;
            border: 3px solid #284a6b;
        }

        .cell {
            background: #0b1825;
            border-radius: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            font-weight: bold;
            color: #e0f0ff;
            cursor: pointer;
            transition: all 0.15s ease;
            box-shadow: 0 8px 0 #03070c, 0 0 0 2px #1f405c;
            aspect-ratio: 1/1;
            text-shadow: 0 0 20px currentColor;
            transform: scale(1);
        }

        .cell:active:not(.taken) {
            transform: translateY(5px);
            box-shadow: 0 3px 0 #03070c, 0 0 0 2px #1f405c;
        }

        .cell.taken {
            cursor: not-allowed;
            filter: brightness(0.9);
            box-shadow: 0 5px 0 #03070c, 0 0 0 2px #1f405c;
            transform: translateY(3px);
        }

        .cell.win {
            background: #2e6b4e;
            color: #fff8b0;
            box-shadow: 0 0 30px #6bd4a0;
            animation: glow 1s infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px #6bd4a0; }
            to { box-shadow: 0 0 40px #a0ffc0; }
        }

        .cell.hint {
            border: 4px solid #ffd966;
            box-shadow: 0 0 25px #f1c40f;
            transform: scale(1.02);
        }

        /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .action-panel {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 15px 0 10px;
            flex-wrap: wrap;
        }

        .action-btn {
            background: #1e3347;
            border: none;
            color: #d6ecff;
            padding: 14px 24px;
            font-size: 1.3rem;
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.1s ease;
            box-shadow: 0 7px 0 #0b1723, 0 0 0 2px #325c82;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            flex: 1 1 150px;
            justify-content: center;
        }

        .action-btn:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #0b1723, 0 0 0 2px #325c82;
        }

        .action-btn:disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        .reset-stats-btn {
            background: #3a2b30;
            box-shadow: 0 7px 0 #201a1e, 0 0 0 2px #a15c6b;
            margin-top: 10px;
        }

        .status {
            font-size: 2rem;
            margin: 10px 0 5px;
            min-height: 70px;
            font-weight: 600;
            color: #c4defa;
            text-shadow: 0 2px 0 #0b1c2b;
            animation: pulse 1.8s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .footer {
            margin-top: 15px;
            font-size: 0.9rem;
            color: #4f6d8f;
        }
    </style>
</head>
<body>
    <!-- –ê—É–¥–∏–æ (–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏) -->
    <audio id="clickSound" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_0b0b0b0b0b.mp3?filename=click-124468.mp3" type="audio/mpeg">
    </audio>
    <audio id="winSound" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_1c1c1c1c1c.mp3?filename=success-1-6297.mp3" type="audio/mpeg">
    </audio>
    <audio id="loseSound" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_2d2d2d2d2d.mp3?filename=error-126627.mp3" type="audio/mpeg">
    </audio>
    <audio id="drawSound" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2022/03/24/audio_3e3e3e3e3e.mp3?filename=cartoon-tap-6086.mp3" type="audio/mpeg">
    </audio>
    <audio id="hintSound" preload="auto">
        <source src="https://cdn.pixabay.com/download/audio/2021/08/12/audio_4f4f4f4f4f.mp3?filename=interface-124464.mp3" type="audio/mpeg">
    </audio>

    <div class="game-container">
        <h1>‚úñÔ∏è DEEP ‚ö° ‚óØ</h1>
        <div class="sub">–ø—Ä–æ—Ç–∏–≤ –ò–ò ‚Ä¢ –ø–æ–¥—Å–∫–∞–∑–∫–∏ ‚Ä¢ —É—Ä–æ–≤–Ω–∏</div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="stats">
            <div class="stat-item">üßë <span class="stat-value" id="playerWins">0</span></div>
            <div class="stat-item">ü§ñ <span class="stat-value" id="robotWins">0</span></div>
            <div class="stat-item">ü§ù <span class="stat-value" id="draws">0</span></div>
        </div>

        <!-- –£—Ä–æ–≤–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ -->
        <div class="difficulty">
            <div class="difficulty-btn active" data-level="easy">üçÉ –õ–µ–≥–∫–∏–π</div>
            <div class="difficulty-btn" data-level="medium">‚öôÔ∏è –°—Ä–µ–¥–Ω–∏–π</div>
            <div class="difficulty-btn" data-level="hard">üíÄ –°–ª–æ–∂–Ω—ã–π</div>
        </div>

        <!-- –ü–æ–ª–µ -->
        <div class="board" id="board">
            <div class="cell" data-index="0"></div>
            <div class="cell" data-index="1"></div>
            <div class="cell" data-index="2"></div>
            <div class="cell" data-index="3"></div>
            <div class="cell" data-index="4"></div>
            <div class="cell" data-index="5"></div>
            <div class="cell" data-index="6"></div>
            <div class="cell" data-index="7"></div>
            <div class="cell" data-index="8"></div>
        </div>

        <!-- –°—Ç–∞—Ç—É—Å -->
        <div class="status" id="status">‚úñÔ∏è –¢–≤–æ–π —Ö–æ–¥</div>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
        <div class="action-panel">
            <button class="action-btn" id="hintBtn">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
            <button class="action-btn" id="newGameBtn">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
        </div>
        <button class="action-btn reset-stats-btn" id="resetStatsBtn">üìä –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</button>

        <div class="footer">–ò–ò –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∏–Ω–∏–º–∞–∫—Å –Ω–∞ —Å–ª–æ–∂–Ω–æ–º</div>
    </div>

    <script>
        (function() {
            // ---------- –≠–ª–µ–º–µ–Ω—Ç—ã ----------
            const boardEl = document.getElementById('board');
            const cells = document.querySelectorAll('.cell');
            const statusEl = document.getElementById('status');
            const playerWinsEl = document.getElementById('playerWins');
            const robotWinsEl = document.getElementById('robotWins');
            const drawsEl = document.getElementById('draws');
            const hintBtn = document.getElementById('hintBtn');
            const newGameBtn = document.getElementById('newGameBtn');
            const resetStatsBtn = document.getElementById('resetStatsBtn');
            const diffBtns = document.querySelectorAll('.difficulty-btn');

            // ---------- –ó–≤—É–∫–∏ ----------
            const clickSound = document.getElementById('clickSound');
            const winSound = document.getElementById('winSound');
            const loseSound = document.getElementById('loseSound');
            const drawSound = document.getElementById('drawSound');
            const hintSound = document.getElementById('hintSound');

            // ---------- –°–æ—Å—Ç–æ—è–Ω–∏–µ ----------
            let board = ['', '', '', '', '', '', '', '', ''];
            let currentPlayer = 'player'; // 'player' –∏–ª–∏ 'robot'
            let gameActive = true;
            let wins = { player: 0, robot: 0, draws: 0 };
            let difficulty = 'easy'; // –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ª–µ–≥–∫–∏–π
            let hintActive = false;
            let hintIndex = -1;

            // –ü–æ–±–µ–¥–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            const winPatterns = [
                [0,1,2],[3,4,5],[6,7,8], // —Å—Ç—Ä–æ–∫–∏
                [0,3,6],[1,4,7],[2,5,8], // —Å—Ç–æ–ª–±—Ü—ã
                [0,4,8],[2,4,6]           // –¥–∏–∞–≥–æ–Ω–∞–ª–∏
            ];

            // ---------- –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–≤—É–∫–æ–≤ ----------
            function playSound(sound) {
                if (sound) {
                    sound.currentTime = 0;
                    sound.play().catch(e => {});
                }
            }

            // ---------- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è ----------
            function checkWinner() {
                for (let pattern of winPatterns) {
                    const [a,b,c] = pattern;
                    if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                        return board[a]; // 'X' –∏–ª–∏ 'O'
                    }
                }
                if (board.every(cell => cell !== '')) return 'draw';
                return null;
            }

            // ---------- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è ----------
            function highlightWinners(symbol) {
                cells.forEach(cell => cell.classList.remove('win'));
                for (let pattern of winPatterns) {
                    const [a,b,c] = pattern;
                    if (board[a] === symbol && board[b] === symbol && board[c] === symbol) {
                        cells[a].classList.add('win');
                        cells[b].classList.add('win');
                        cells[c].classList.add('win');
                    }
                }
            }

            // ---------- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ ----------
            function updateStatus(text) {
                statusEl.innerText = text;
            }

            // ---------- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ ----------
            function updateStatsUI() {
                playerWinsEl.innerText = wins.player;
                robotWinsEl.innerText = wins.robot;
                drawsEl.innerText = wins.draws;
            }

            // ---------- –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã ----------
            function endGame(winner) {
                gameActive = false;
                hintBtn.disabled = true;
                if (winner === 'X') {
                    wins.player++;
                    highlightWinners('X');
                    updateStatus('‚úñÔ∏è –¢—ã –≤—ã–∏–≥—Ä–∞–ª!');
                    playSound(winSound);
                } else if (winner === 'O') {
                    wins.robot++;
                    highlightWinners('O');
                    updateStatus('ü§ñ –†–æ–±–æ—Ç –ø–æ–±–µ–¥–∏–ª');
                    playSound(loseSound);
                } else if (winner === 'draw') {
                    wins.draws++;
                    updateStatus('ü§ù –ù–∏—á—å—è');
                    playSound(drawSound);
                }
                updateStatsUI();
            }

            // ---------- –û—Ü–µ–Ω–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –º–∏–Ω–∏–º–∞–∫—Å–∞ (—Å–ª–æ–∂–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å) ----------
            function evaluate(board) {
                for (let pattern of winPatterns) {
                    const [a,b,c] = pattern;
                    if (board[a] === 'O' && board[b] === 'O' && board[c] === 'O') return 10;
                    if (board[a] === 'X' && board[b] === 'X' && board[c] === 'X') return -10;
                }
                return 0;
            }

            // –ú–∏–Ω–∏–º–∞–∫—Å (—Å–ª–æ–∂–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)
            function minimax(board, depth, isMax) {
                let score = evaluate(board);
                if (score === 10 || score === -10) return score;
                if (!board.includes('')) return 0;

                if (isMax) {
                    let best = -Infinity;
                    for (let i = 0; i < 9; i++) {
                        if (board[i] === '') {
                            board[i] = 'O';
                            best = Math.max(best, minimax(board, depth+1, false));
                            board[i] = '';
                        }
                    }
                    return best;
                } else {
                    let best = Infinity;
                    for (let i = 0; i < 9; i++) {
                        if (board[i] === '') {
                            board[i] = 'X';
                            best = Math.min(best, minimax(board, depth+1, true));
                            board[i] = '';
                        }
                    }
                    return best;
                }
            }

            // –ü–æ–ª—É—á–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ —Ö–æ–¥–∞ –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è
            function getBestMove(board) {
                let bestVal = -Infinity;
                let bestMove = -1;
                for (let i = 0; i < 9; i++) {
                    if (board[i] === '') {
                        board[i] = 'O';
                        let moveVal = minimax(board, 0, false);
                        board[i] = '';
                        if (moveVal > bestVal) {
                            bestVal = moveVal;
                            bestMove = i;
                        }
                    }
                }
                return bestMove;
            }

            // ---------- –•–æ–¥ —Ä–æ–±–æ—Ç–∞ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏) ----------
            function robotMove() {
                if (!gameActive || currentPlayer !== 'robot') return;

                let moveIndex = -1;

                if (difficulty === 'easy') {
                    // –õ—ë–≥–∫–∏–π: —Å–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
                    const available = board.reduce((acc, cell, idx) => cell === '' ? [...acc, idx] : acc, []);
                    if (available.length > 0) {
                        moveIndex = available[Math.floor(Math.random() * available.length)];
                    }
                } else if (difficulty === 'medium') {
                    // –°—Ä–µ–¥–Ω–∏–π: –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –∑–∞—â–∏—Ç—ã –∏ –∞—Ç–∞–∫–∏ (–∫–∞–∫ —Å—Ç–∞—Ä—ã–π —Ä–æ–±–æ—Ç)
                    // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—ã–∏–≥—Ä–∞—Ç—å
                    for (let pattern of winPatterns) {
                        const [a,b,c] = pattern;
                        if (board[a] === 'O' && board[b] === 'O' && board[c] === '') moveIndex = c;
                        else if (board[a] === 'O' && board[c] === 'O' && board[b] === '') moveIndex = b;
                        else if (board[b] === 'O' && board[c] === 'O' && board[a] === '') moveIndex = a;
                    }
                    if (moveIndex === -1) {
                        // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä–æ–∫–∞
                        for (let pattern of winPatterns) {
                            const [a,b,c] = pattern;
                            if (board[a] === 'X' && board[b] === 'X' && board[c] === '') moveIndex = c;
                            else if (board[a] === 'X' && board[c] === 'X' && board[b] === '') moveIndex = b;
                            else if (board[b] === 'X' && board[c] === 'X' && board[a] === '') moveIndex = a;
                        }
                    }
                    if (moveIndex === -1 && board[4] === '') moveIndex = 4; // —Ü–µ–Ω—Ç—Ä
                    if (moveIndex === -1) {
                        const corners = [0,2,6,8];
                        const availableCorners = corners.filter(i => board[i] === '');
                        if (availableCorners.length > 0) {
                            moveIndex = availableCorners[Math.floor(Math.random() * availableCorners.length)];
                        }
                    }
                    if (moveIndex === -1) {
                        const available = board.reduce((acc, cell, idx) => cell === '' ? [...acc, idx] : acc, []);
                        if (available.length > 0) {
                            moveIndex = available[Math.floor(Math.random() * available.length)];
                        }
                    }
                } else {
                    // –°–ª–æ–∂–Ω—ã–π: –º–∏–Ω–∏–º–∞–∫—Å
                    moveIndex = getBestMove([...board]);
                }

                if (moveIndex === -1 || board[moveIndex] !== '') return;

                // –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ö–æ–¥ —Ä–æ–±–æ—Ç–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
                setTimeout(() => {
                    if (!gameActive || currentPlayer !== 'robot') return;

                    board[moveIndex] = 'O';
                    cells[moveIndex].innerText = 'O';
                    cells[moveIndex].classList.add('taken');
                    playSound(clickSound);

                    const winner = checkWinner();
                    if (winner) {
                        endGame(winner);
                    } else {
                        currentPlayer = 'player';
                        updateStatus('‚úñÔ∏è –¢–≤–æ–π —Ö–æ–¥');
                        hintBtn.disabled = false;
                        hintActive = false;
                        removeHint();
                    }
                }, 300);
            }

            // ---------- –£–±—Ä–∞—Ç—å –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø–æ–¥—Å–∫–∞–∑–∫–∏ ----------
            function removeHint() {
                cells.forEach(c => c.classList.remove('hint'));
                hintActive = false;
                hintIndex = -1;
            }

            // ---------- –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É ----------
            function showHint() {
                if (!gameActive || currentPlayer !== 'player') {
                    playSound(hintSound); // –ø—Ä–æ—Å—Ç–æ –∑–≤—É–∫, –Ω–æ –ø–æ–¥—Å–∫–∞–∑–∫–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω–∞
                    return;
                }

                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ò–ò –¥–ª—è –ª—É—á—à–µ–≥–æ —Ö–æ–¥–∞ (–Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –Ω–æ –¥–ª—è –∏–≥—Ä–æ–∫–∞)
                // –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É —Ä–æ–±–æ—Ç–∞, –Ω–æ –¥–ª—è X (–∏–≥—Ä–æ–∫–∞)
                let bestMove = -1;
                if (difficulty === 'easy') {
                    // –î–ª—è –ª—ë–≥–∫–æ–≥–æ: —Å–ª—É—á–∞–π–Ω—ã–π –ø—É—Å—Ç–æ–π
                    const available = board.reduce((acc, cell, idx) => cell === '' ? [...acc, idx] : acc, []);
                    if (available.length > 0) {
                        bestMove = available[Math.floor(Math.random() * available.length)];
                    }
                } else if (difficulty === 'medium') {
                    // –î–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ: –ø–æ—Å—Ç–∞—Ä–∞—Ç—å—Å—è –≤—ã–±—Ä–∞—Ç—å –Ω–µ–ø—Ä–æ–∏–≥—Ä—ã—à–Ω—ã–π
                    // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º, –º–æ–∂–µ—Ç –ª–∏ –∏–≥—Ä–æ–∫ –≤—ã–∏–≥—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–º —Ö–æ–¥–æ–º?
                    for (let pattern of winPatterns) {
                        const [a,b,c] = pattern;
                        if (board[a] === 'X' && board[b] === 'X' && board[c] === '') bestMove = c;
                        else if (board[a] === 'X' && board[c] === 'X' && board[b] === '') bestMove = b;
                        else if (board[b] === 'X' && board[c] === 'X' && board[a] === '') bestMove = a;
                    }
                    if (bestMove === -1) {
                        // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—É—é –ø–æ–±–µ–¥—É —Ä–æ–±–æ—Ç–∞
                        for (let pattern of winPatterns) {
                            const [a,b,c] = pattern;
                            if (board[a] === 'O' && board[b] === 'O' && board[c] === '') bestMove = c;
                            else if (board[a] === 'O' && board[c] === 'O' && board[b] === '') bestMove = b;
                            else if (board[b] === 'O' && board[c] === 'O' && board[a] === '') bestMove = a;
                        }
                    }
                    if (bestMove === -1 && board[4] === '') bestMove = 4;
                    if (bestMove === -1) {
                        const corners = [0,2,6,8];
                        const availableCorners = corners.filter(i => board[i] === '');
                        if (availableCorners.length > 0) {
                            bestMove = availableCorners[Math.floor(Math.random() * availableCorners.length)];
                        }
                    }
                    if (bestMove === -1) {
                        const available = board.reduce((acc, cell, idx) => cell === '' ? [...acc, idx] : acc, []);
                        if (available.length > 0) {
                            bestMove = available[Math.floor(Math.random() * available.length)];
                        }
                    }
                } else {
                    // –°–ª–æ–∂–Ω—ã–π: –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∏–Ω–∏–º–∞–∫—Å, –Ω–æ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ (X) ‚Äî –¥–ª—è –º–∏–Ω–∏–º–∞–∫—Å–∞ –Ω—É–∂–Ω–æ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
                    // –ú–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –ø—Ä–æ—â–µ: –º–∏–Ω–∏–º–∞–∫—Å –¥–ª—è —Ä–æ–±–æ—Ç–∞, –Ω–æ —Å –¥–æ—Å–∫–∏ –≥–¥–µ —Ä–æ–±–æ—Ç - O, –∞ –Ω–∞–º –Ω—É–∂–µ–Ω –ª—É—á—à–∏–π –¥–ª—è X
                    // –î–ª—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ –º–∏–Ω–∏–º–∞–∫—Å, –Ω–æ —Å—á–∏—Ç–∞–µ–º —á—Ç–æ —Ä–æ–±–æ—Ç —Ö–æ–¥–∏—Ç O, –∞ –∏–≥—Ä–æ–∫ X
                    // –ù–∞–π–¥—ë–º —Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —à–∞–Ω—Å—ã —Ä–æ–±–æ—Ç–∞ (—Ç–æ –µ—Å—Ç—å –ª—É—á—à–∏–π –¥–ª—è X)
                    let bestVal = Infinity;
                    for (let i = 0; i < 9; i++) {
                        if (board[i] === '') {
                            board[i] = 'X';
                            let moveVal = minimax(board, 0, true); // —Ç—É—Ç true, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥ —Ä–æ–±–æ—Ç–∞ (O) –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç
                            board[i] = '';
                            if (moveVal < bestVal) {
                                bestVal = moveVal;
                                bestMove = i;
                            }
                        }
                    }
                }

                if (bestMove !== -1 && board[bestMove] === '') {
                    removeHint();
                    cells[bestMove].classList.add('hint');
                    hintActive = true;
                    hintIndex = bestMove;
                    playSound(hintSound);
                } else {
                    // –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫ (–æ–±—ã—á–Ω–æ –Ω–µ –±—ã–≤–∞–µ—Ç)
                }
            }

            // ---------- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–ª–µ—Ç–∫–µ ----------
            function handleCellClick(e) {
                const cell = e.target;
                const index = cell.dataset.index;

                if (!gameActive || currentPlayer !== 'player' || board[index] !== '') return;

                // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
                removeHint();

                // –•–æ–¥ –∏–≥—Ä–æ–∫–∞
                board[index] = 'X';
                cell.innerText = 'X';
                cell.classList.add('taken');
                playSound(clickSound);

                const winner = checkWinner();
                if (winner) {
                    endGame(winner);
                    hintBtn.disabled = true;
                } else {
                    currentPlayer = 'robot';
                    updateStatus('ü§ñ –î—É–º–∞–µ—Ç...');
                    hintBtn.disabled = true;
                    robotMove();
                }
            }

            // ---------- –ù–æ–≤–∞—è –∏–≥—Ä–∞ ----------
            function newGame() {
                board = ['', '', '', '', '', '', '', '', ''];
                currentPlayer = 'player';
                gameActive = true;

                cells.forEach(cell => {
                    cell.innerText = '';
                    cell.classList.remove('taken', 'win', 'hint');
                });

                updateStatus('‚úñÔ∏è –¢–≤–æ–π —Ö–æ–¥');
                hintBtn.disabled = false;
                hintActive = false;
            }

            // ---------- –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ----------
            function resetStats() {
                wins = { player: 0, robot: 0, draws: 0 };
                updateStatsUI();
                newGame();
            }

            // ---------- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ ----------
            function setDifficulty(level) {
                difficulty = level;
                diffBtns.forEach(btn => {
                    if (btn.dataset.level === level) btn.classList.add('active');
                    else btn.classList.remove('active');
                });
                newGame(); // –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É –ø—Ä–∏ —Å–º–µ–Ω–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            }

            // ---------- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ ----------
            cells.forEach(cell => cell.addEventListener('click', handleCellClick));

            hintBtn.addEventListener('click', () => {
                if (!gameActive || currentPlayer !== 'player') {
                    playSound(hintSound); // –ø—Ä–æ—Å—Ç–æ –∑–≤—É–∫ –æ—à–∏–±–∫–∏
                    return;
                }
                showHint();
            });

            newGameBtn.addEventListener('click', () => {
                newGame();
                playSound(clickSound);
            });

            resetStatsBtn.addEventListener('click', () => {
                resetStats();
                playSound(clickSound);
            });

            diffBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    setDifficulty(btn.dataset.level);
                    playSound(clickSound);
                });
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            newGame();
            updateStatsUI();

            // –ê–≤—Ç–æ—Å—Ç–∞—Ä—Ç –∑–≤—É–∫–æ–≤ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
            document.body.addEventListener('touchstart', function once() {
                // –ø—Ä–æ—Å—Ç–æ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ–º –∞—É–¥–∏–æ–∫–æ–Ω—Ç–µ–∫—Å—Ç
                document.body.removeEventListener('touchstart', once);
            });
        })();
    </script>
</body>
</html>
